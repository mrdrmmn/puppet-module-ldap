<%-
  config = scope.to_hash
  config = scope.parent.to_hash if ! config.has_key?( 'server_nodes' )
%>
# Default location of the slapd.conf file or slapd.d cn=config directory. If
# empty, use the compiled-in default (/etc/ldap/slapd.d with a fallback to
# /etc/ldap/slapd.conf).
<% if config['ldap_conf_dir'] != '' and config['ldap_conf_dir'] != :undef -%>
SLAPD_CONF="<%= config['ldap_conf_dir'] %>"
<% else -%>
SLAPD_CONF=
<% end -%>

# System account to run the slapd server under. If empty the server
# will run as root.
<% if config['user'] != '' and config['user'] != :undef -%>
SLAPD_USER="<%= config['user'] %>"
<% else -%>
SLAPD_USER=
<% end -%>

# System group to run the slapd server under. If empty the server will
# run in the primary group of its user.
<% if config['group'] != '' and config['group'] != :undef -%>
SLAPD_GROUP="<%= config['group'] %>"
<% else -%>
SLAPD_GROUP=
<% end -%>

# Path to the pid file of the slapd server. If not set the init.d script
# will try to figure it out from $SLAPD_CONF (/etc/ldap/slapd.d by
# default)
<% if config['pid_file'] != '' and config['pid_file'] != :undef -%>
SLAPD_PIDFILE="<%= config['pid_file'] %>"
<% else -%>
SLAPD_PIDFILE=
<% end -%>

# slapd normally serves ldap only on all TCP-ports 389. slapd can also
# service requests on TCP-port 636 (ldaps) and requests via unix
# sockets.
# Example usage:
# SLAPD_SERVICES="ldap://127.0.0.1:389/ ldaps:/// ldapi:///"
SLAPD_SERVICES="<%= scope.function_template( 'ldap/generate-local-uris.erb' ) %>"

# If SLAPD_NO_START is set, the init script will not start or restart
# slapd (but stop will still work).  Uncomment this if you are
# starting slapd via some other means or if you don't want slapd normally
# started at boot.
#SLAPD_NO_START=1

# If SLAPD_SENTINEL_FILE is set to path to a file and that file exists,
# the init script will not start or restart slapd (but stop will still
# work).  Use this for temporarily disabling startup of slapd (when doing
# maintenance, for example, or through a configuration management system)
# when you don't want to edit a configuration file.
SLAPD_SENTINEL_FILE=/etc/ldap/noslapd

# For Kerberos authentication (via SASL), slapd by default uses the system
# keytab file (/etc/krb5.keytab).  To use a different keytab file,
# uncomment this line and change the path.
#export KRB5_KTNAME=/etc/krb5.keytab

# Additional options to pass to slapd
SLAPD_OPTIONS=""
